"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = void 0;
var _asyncOra = require("@electron-forge/async-ora");
var _electronRebuild = require("electron-rebuild");
var _default = async (buildPath, electronVersion, platform, arch, config = {})=>{
    await (0, _asyncOra).asyncOra('Preparing native dependencies', async (rebuildSpinner)=>{
        const rebuilder = (0, _electronRebuild).rebuild({
            ...config,
            buildPath,
            electronVersion,
            arch
        });
        const { lifecycle  } = rebuilder;
        let found = 0;
        let done = 0;
        const redraw = ()=>{
            rebuildSpinner.text = `Preparing native dependencies: ${done} / ${found}`;
        };
        lifecycle.on('module-found', ()=>{
            found += 1;
            redraw();
        });
        lifecycle.on('module-done', ()=>{
            done += 1;
            redraw();
        });
        await rebuilder;
    });
};
exports.default = _default;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL3JlYnVpbGQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXN5bmNPcmEgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvYXN5bmMtb3JhJztcbmltcG9ydCB7IEZvcmdlUGxhdGZvcm0sIEZvcmdlQXJjaCB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9zaGFyZWQtdHlwZXMnO1xuXG5pbXBvcnQgeyByZWJ1aWxkLCBSZWJ1aWxkT3B0aW9ucyB9IGZyb20gJ2VsZWN0cm9uLXJlYnVpbGQnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAoXG4gIGJ1aWxkUGF0aDogc3RyaW5nLFxuICBlbGVjdHJvblZlcnNpb246IHN0cmluZyxcbiAgcGxhdGZvcm06IEZvcmdlUGxhdGZvcm0sXG4gIGFyY2g6IEZvcmdlQXJjaCxcbiAgY29uZmlnOiBQYXJ0aWFsPFJlYnVpbGRPcHRpb25zPiA9IHt9XG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgYXdhaXQgYXN5bmNPcmEoJ1ByZXBhcmluZyBuYXRpdmUgZGVwZW5kZW5jaWVzJywgYXN5bmMgKHJlYnVpbGRTcGlubmVyKSA9PiB7XG4gICAgY29uc3QgcmVidWlsZGVyID0gcmVidWlsZCh7XG4gICAgICAuLi5jb25maWcsXG4gICAgICBidWlsZFBhdGgsXG4gICAgICBlbGVjdHJvblZlcnNpb24sXG4gICAgICBhcmNoLFxuICAgIH0pO1xuICAgIGNvbnN0IHsgbGlmZWN5Y2xlIH0gPSByZWJ1aWxkZXI7XG5cbiAgICBsZXQgZm91bmQgPSAwO1xuICAgIGxldCBkb25lID0gMDtcblxuICAgIGNvbnN0IHJlZHJhdyA9ICgpID0+IHtcbiAgICAgIHJlYnVpbGRTcGlubmVyLnRleHQgPSBgUHJlcGFyaW5nIG5hdGl2ZSBkZXBlbmRlbmNpZXM6ICR7ZG9uZX0gLyAke2ZvdW5kfWA7XG4gICAgfTtcblxuICAgIGxpZmVjeWNsZS5vbignbW9kdWxlLWZvdW5kJywgKCkgPT4ge1xuICAgICAgZm91bmQgKz0gMTtcbiAgICAgIHJlZHJhdygpO1xuICAgIH0pO1xuICAgIGxpZmVjeWNsZS5vbignbW9kdWxlLWRvbmUnLCAoKSA9PiB7XG4gICAgICBkb25lICs9IDE7XG4gICAgICByZWRyYXcoKTtcbiAgICB9KTtcblxuICAgIGF3YWl0IHJlYnVpbGRlcjtcbiAgfSk7XG59O1xuIl0sIm5hbWVzIjpbImJ1aWxkUGF0aCIsImVsZWN0cm9uVmVyc2lvbiIsInBsYXRmb3JtIiwiYXJjaCIsImNvbmZpZyIsImFzeW5jT3JhIiwicmVidWlsZFNwaW5uZXIiLCJyZWJ1aWxkZXIiLCJyZWJ1aWxkIiwibGlmZWN5Y2xlIiwiZm91bmQiLCJkb25lIiwicmVkcmF3IiwidGV4dCIsIm9uIl0sIm1hcHBpbmdzIjoiOzs7OztBQUF5QixHQUEyQixDQUEzQixTQUEyQjtBQUdaLEdBQWtCLENBQWxCLGdCQUFrQjtzQkFHeERBLFNBQWlCLEVBQ2pCQyxlQUF1QixFQUN2QkMsUUFBdUIsRUFDdkJDLElBQWUsRUFDZkMsTUFBK0IsR0FBRyxDQUFDLENBQUMsR0FDbEIsQ0FBQztJQUNuQixLQUFLLEtBQUNDLFNBQVEsV0FBQyxDQUErQix1Q0FBU0MsY0FBYyxHQUFLLENBQUM7UUFDekUsS0FBSyxDQUFDQyxTQUFTLE9BQUdDLGdCQUFPLFVBQUMsQ0FBQztlQUN0QkosTUFBTTtZQUNUSixTQUFTO1lBQ1RDLGVBQWU7WUFDZkUsSUFBSTtRQUNOLENBQUM7UUFDRCxLQUFLLENBQUMsQ0FBQyxDQUFDTSxTQUFTLEVBQUMsQ0FBQyxHQUFHRixTQUFTO1FBRS9CLEdBQUcsQ0FBQ0csS0FBSyxHQUFHLENBQUM7UUFDYixHQUFHLENBQUNDLElBQUksR0FBRyxDQUFDO1FBRVosS0FBSyxDQUFDQyxNQUFNLE9BQVMsQ0FBQztZQUNwQk4sY0FBYyxDQUFDTyxJQUFJLElBQUksK0JBQStCLEVBQUVGLElBQUksQ0FBQyxHQUFHLEVBQUVELEtBQUs7UUFDekUsQ0FBQztRQUVERCxTQUFTLENBQUNLLEVBQUUsQ0FBQyxDQUFjLG1CQUFRLENBQUM7WUFDbENKLEtBQUssSUFBSSxDQUFDO1lBQ1ZFLE1BQU07UUFDUixDQUFDO1FBQ0RILFNBQVMsQ0FBQ0ssRUFBRSxDQUFDLENBQWEsa0JBQVEsQ0FBQztZQUNqQ0gsSUFBSSxJQUFJLENBQUM7WUFDVEMsTUFBTTtRQUNSLENBQUM7UUFFRCxLQUFLLENBQUNMLFNBQVM7SUFDakIsQ0FBQztBQUNILENBQUMifQ==