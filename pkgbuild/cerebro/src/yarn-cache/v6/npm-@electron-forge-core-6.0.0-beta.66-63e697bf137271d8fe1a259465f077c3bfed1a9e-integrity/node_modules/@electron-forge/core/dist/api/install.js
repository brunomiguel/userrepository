"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = void 0;
var _asyncOra = require("@electron-forge/async-ora");
var _chalk = _interopRequireDefault(require("chalk"));
var _debug = _interopRequireDefault(require("debug"));
var _nodeFetch = _interopRequireDefault(require("node-fetch"));
var _fsExtra = _interopRequireDefault(require("fs-extra"));
var _os = _interopRequireDefault(require("os"));
var _path = _interopRequireDefault(require("path"));
var _semver = _interopRequireDefault(require("semver"));
var _installerBase = _interopRequireDefault(require("@electron-forge/installer-base"));
var _installerDmg = _interopRequireDefault(require("@electron-forge/installer-dmg"));
var _installerZip = _interopRequireDefault(require("@electron-forge/installer-zip"));
var _installerDeb = _interopRequireDefault(require("@electron-forge/installer-deb"));
var _installerRpm = _interopRequireDefault(require("@electron-forge/installer-rpm"));
var _installerExe = _interopRequireDefault(require("@electron-forge/installer-exe"));
var _messages = require("../util/messages");
var _downloadToFile = require("../util/download-to-file");
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const d = (0, _debug).default('electron-forge:install');
const GITHUB_API = 'https://api.github.com';
class InstallerImpl extends _installerBase.default {
    constructor(...args){
        super(...args);
        this.name = 'impl';
    }
}
var _default = async ({ interactive =false , prerelease =false , repo , chooseAsset  })=>{
    _asyncOra.asyncOra.interactive = interactive;
    if (typeof chooseAsset !== 'function') {
        throw new Error('Expected chooseAsset to be a function in install call');
    }
    let latestRelease;
    let possibleAssets = [];
    await (0, _asyncOra).asyncOra('Searching for Application', async (searchSpinner)=>{
        if (!repo || !repo.includes('/')) {
            throw new Error('Invalid repository name, must be in the format owner/name');
        }
        d('searching for repo:', repo);
        let releases;
        try {
            releases = await (await (0, _nodeFetch).default(`${GITHUB_API}/repos/${repo}/releases`)).json();
        } catch (err) {
        // Ignore error
        }
        // TODO: fix up the type so that errors are handled correctly
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        if (!releases || releases.message === 'Not Found' || !Array.isArray(releases)) {
            throw new Error(`Failed to find releases for repository "${repo}".  Please check the name and try again.`);
        }
        if (releases.length === 0) {
            throw new Error(`Repository "${repo}" has no releases`);
        }
        releases = releases.filter((release)=>!release.prerelease || prerelease
        );
        const sortedReleases = releases.sort((releaseA, releaseB)=>{
            let tagA = releaseA.tag_name;
            if (tagA.substr(0, 1) === 'v') tagA = tagA.substr(1);
            let tagB = releaseB.tag_name;
            if (tagB.substr(0, 1) === 'v') tagB = tagB.substr(1);
            return _semver.default.gt(tagB, tagA) ? 1 : -1;
        });
        // eslint-disable-next-line prefer-destructuring
        latestRelease = sortedReleases[0];
        searchSpinner.text = 'Searching for Releases';
        const { assets  } = latestRelease;
        if (!assets || !Array.isArray(assets) || assets.length === 0) {
            throw new Error('Could not find any assets for the latest release');
        }
        const installTargets = {
            win32: [
                /\.exe$/
            ],
            darwin: [
                /OSX.*\.zip$/,
                /darwin.*\.zip$/,
                /macOS.*\.zip$/,
                /mac.*\.zip$/,
                /\.dmg$/
            ],
            linux: [
                /\.rpm$/,
                /\.deb$/
            ]
        };
        possibleAssets = assets.filter((asset)=>{
            const targetSuffixes = installTargets[process.platform];
            for (const suffix of targetSuffixes){
                if (suffix.test(asset.name)) return true;
            }
            return false;
        });
        if (possibleAssets.length === 0) {
            throw new Error(`Failed to find any installable assets for target platform: ${_chalk.default.cyan(`${process.platform}`)}`);
        }
    });
    (0, _messages).info(interactive, `Found latest release${prerelease ? ' (including prereleases)' : ''}: ${_chalk.default.cyan(latestRelease.tag_name)}`);
    let targetAsset = possibleAssets[0];
    if (possibleAssets.length > 1) {
        targetAsset = await Promise.resolve(chooseAsset(possibleAssets));
    }
    const tmpdir = _path.default.resolve(_os.default.tmpdir(), 'forge-install');
    const pathSafeRepo = repo.replace(/[/\\]/g, '-');
    const filename = `${pathSafeRepo}-${latestRelease.tag_name}-${targetAsset.name}`;
    const fullFilePath = _path.default.resolve(tmpdir, filename);
    if (!await _fsExtra.default.pathExists(fullFilePath) || (await _fsExtra.default.stat(fullFilePath)).size !== targetAsset.size) {
        await _fsExtra.default.mkdirs(tmpdir);
        await (0, _downloadToFile).downloadToFile(fullFilePath, targetAsset.browser_download_url);
    }
    await (0, _asyncOra).asyncOra('Installing Application', async (installSpinner)=>{
        const installActions = {
            win32: {
                '.exe': _installerExe.default
            },
            darwin: {
                '.zip': _installerZip.default,
                '.dmg': _installerDmg.default
            },
            linux: {
                '.deb': _installerDeb.default,
                '.rpm': _installerRpm.default
            }
        };
        const suffixFnIdent = Object.keys(installActions[process.platform]).find((suffix)=>targetAsset.name.endsWith(suffix)
        );
        if (!suffixFnIdent) {
            throw new Error(`No installer to handle "${targetAsset.name}"`);
        }
        const InstallerClass = installActions[process.platform][suffixFnIdent];
        const installer = new InstallerClass();
        await installer.install({
            installSpinner,
            filePath: fullFilePath
        });
    });
};
exports.default = _default;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvaW5zdGFsbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhc3luY09yYSB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9hc3luYy1vcmEnO1xuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJztcbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZmV0Y2ggZnJvbSAnbm9kZS1mZXRjaCc7XG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHNlbXZlciBmcm9tICdzZW12ZXInO1xuXG5pbXBvcnQgSW5zdGFsbGVyQmFzZSBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvaW5zdGFsbGVyLWJhc2UnO1xuaW1wb3J0IERNR0luc3RhbGxlciBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvaW5zdGFsbGVyLWRtZyc7XG5pbXBvcnQgWmlwSW5zdGFsbGVyIGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9pbnN0YWxsZXItemlwJztcbmltcG9ydCBEZWJJbnN0YWxsZXIgZnJvbSAnQGVsZWN0cm9uLWZvcmdlL2luc3RhbGxlci1kZWInO1xuaW1wb3J0IFJQTUluc3RhbGxlciBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvaW5zdGFsbGVyLXJwbSc7XG5pbXBvcnQgRXhlSW5zdGFsbGVyIGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9pbnN0YWxsZXItZXhlJztcblxuaW1wb3J0IHsgaW5mbyB9IGZyb20gJy4uL3V0aWwvbWVzc2FnZXMnO1xuaW1wb3J0IHsgZG93bmxvYWRUb0ZpbGUgfSBmcm9tICcuLi91dGlsL2Rvd25sb2FkLXRvLWZpbGUnO1xuXG5jb25zdCBkID0gZGVidWcoJ2VsZWN0cm9uLWZvcmdlOmluc3RhbGwnKTtcblxuY29uc3QgR0lUSFVCX0FQSSA9ICdodHRwczovL2FwaS5naXRodWIuY29tJztcblxuY2xhc3MgSW5zdGFsbGVySW1wbCBleHRlbmRzIEluc3RhbGxlckJhc2Uge1xuICBuYW1lID0gJ2ltcGwnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzaXplOiBudW1iZXI7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgYnJvd3Nlcl9kb3dubG9hZF91cmw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFJlbGVhc2Uge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gIHRhZ19uYW1lOiBzdHJpbmc7XG4gIHByZXJlbGVhc2U6IGJvb2xlYW47XG4gIGFzc2V0czogQXNzZXRbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbnN0YWxsT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIHVzZSBzZW5zaWJsZSBkZWZhdWx0cyBvciBwcm9tcHQgdGhlIHVzZXIgdmlzdWFsbHlcbiAgICovXG4gIGludGVyYWN0aXZlPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gaW5zdGFsbCBwcmVyZWxlYXNlIHZlcnNpb25zXG4gICAqL1xuICBwcmVyZWxlYXNlPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIFRoZSBHaXRIdWIgcmVwb3NpdG9yeSB0byBpbnN0YWxsIGZyb20sIGluIHRoZSBmb3JtYXQgb3duZXIvbmFtZVxuICAgKi9cbiAgcmVwbzogc3RyaW5nO1xuICAvKipcbiAgICogQSBmdW5jdGlvbiB0aGF0IG11c3QgcmV0dXJuIHRoZSBhc3NldCB0byB1c2UvaW5zdGFsbCBmcm9tIGEgcHJvdmlkZWQgYXJyYXkgb2YgY29tcGF0aWJsZVxuICAgKiBHaXRIdWIgYXNzZXRzLlxuICAgKi9cbiAgY2hvb3NlQXNzZXQ6IChhc3NldHM6IEFzc2V0W10pID0+IFByb21pc2U8QXNzZXQ+IHwgQXNzZXQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jICh7IGludGVyYWN0aXZlID0gZmFsc2UsIHByZXJlbGVhc2UgPSBmYWxzZSwgcmVwbywgY2hvb3NlQXNzZXQgfTogSW5zdGFsbE9wdGlvbnMpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgYXN5bmNPcmEuaW50ZXJhY3RpdmUgPSBpbnRlcmFjdGl2ZTtcblxuICBpZiAodHlwZW9mIGNob29zZUFzc2V0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBjaG9vc2VBc3NldCB0byBiZSBhIGZ1bmN0aW9uIGluIGluc3RhbGwgY2FsbCcpO1xuICB9XG5cbiAgbGV0IGxhdGVzdFJlbGVhc2UhOiBSZWxlYXNlO1xuICBsZXQgcG9zc2libGVBc3NldHM6IEFzc2V0W10gPSBbXTtcblxuICBhd2FpdCBhc3luY09yYSgnU2VhcmNoaW5nIGZvciBBcHBsaWNhdGlvbicsIGFzeW5jIChzZWFyY2hTcGlubmVyKSA9PiB7XG4gICAgaWYgKCFyZXBvIHx8ICFyZXBvLmluY2x1ZGVzKCcvJykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXBvc2l0b3J5IG5hbWUsIG11c3QgYmUgaW4gdGhlIGZvcm1hdCBvd25lci9uYW1lJyk7XG4gICAgfVxuXG4gICAgZCgnc2VhcmNoaW5nIGZvciByZXBvOicsIHJlcG8pO1xuICAgIGxldCByZWxlYXNlcyE6IFJlbGVhc2VbXTtcbiAgICB0cnkge1xuICAgICAgcmVsZWFzZXMgPSBhd2FpdCAoYXdhaXQgZmV0Y2goYCR7R0lUSFVCX0FQSX0vcmVwb3MvJHtyZXBvfS9yZWxlYXNlc2ApKS5qc29uKCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBJZ25vcmUgZXJyb3JcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBmaXggdXAgdGhlIHR5cGUgc28gdGhhdCBlcnJvcnMgYXJlIGhhbmRsZWQgY29ycmVjdGx5XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBpZiAoIXJlbGVhc2VzIHx8IChyZWxlYXNlcyBhcyBhbnkpLm1lc3NhZ2UgPT09ICdOb3QgRm91bmQnIHx8ICFBcnJheS5pc0FycmF5KHJlbGVhc2VzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmluZCByZWxlYXNlcyBmb3IgcmVwb3NpdG9yeSBcIiR7cmVwb31cIi4gIFBsZWFzZSBjaGVjayB0aGUgbmFtZSBhbmQgdHJ5IGFnYWluLmApO1xuICAgIH1cblxuICAgIGlmIChyZWxlYXNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUmVwb3NpdG9yeSBcIiR7cmVwb31cIiBoYXMgbm8gcmVsZWFzZXNgKTtcbiAgICB9XG5cbiAgICByZWxlYXNlcyA9IHJlbGVhc2VzLmZpbHRlcigocmVsZWFzZSkgPT4gIXJlbGVhc2UucHJlcmVsZWFzZSB8fCBwcmVyZWxlYXNlKTtcblxuICAgIGNvbnN0IHNvcnRlZFJlbGVhc2VzID0gcmVsZWFzZXMuc29ydCgocmVsZWFzZUEsIHJlbGVhc2VCKSA9PiB7XG4gICAgICBsZXQgdGFnQSA9IHJlbGVhc2VBLnRhZ19uYW1lO1xuICAgICAgaWYgKHRhZ0Euc3Vic3RyKDAsIDEpID09PSAndicpIHRhZ0EgPSB0YWdBLnN1YnN0cigxKTtcbiAgICAgIGxldCB0YWdCID0gcmVsZWFzZUIudGFnX25hbWU7XG4gICAgICBpZiAodGFnQi5zdWJzdHIoMCwgMSkgPT09ICd2JykgdGFnQiA9IHRhZ0Iuc3Vic3RyKDEpO1xuICAgICAgcmV0dXJuIHNlbXZlci5ndCh0YWdCLCB0YWdBKSA/IDEgOiAtMTtcbiAgICB9KTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcbiAgICBsYXRlc3RSZWxlYXNlID0gc29ydGVkUmVsZWFzZXNbMF07XG5cbiAgICBzZWFyY2hTcGlubmVyLnRleHQgPSAnU2VhcmNoaW5nIGZvciBSZWxlYXNlcyc7XG5cbiAgICBjb25zdCB7IGFzc2V0cyB9ID0gbGF0ZXN0UmVsZWFzZTtcbiAgICBpZiAoIWFzc2V0cyB8fCAhQXJyYXkuaXNBcnJheShhc3NldHMpIHx8IGFzc2V0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgYW55IGFzc2V0cyBmb3IgdGhlIGxhdGVzdCByZWxlYXNlJyk7XG4gICAgfVxuXG4gICAgY29uc3QgaW5zdGFsbFRhcmdldHM6IHtcbiAgICAgIFtrZXk6IHN0cmluZ106IFJlZ0V4cFtdO1xuICAgIH0gPSB7XG4gICAgICB3aW4zMjogWy9cXC5leGUkL10sXG4gICAgICBkYXJ3aW46IFsvT1NYLipcXC56aXAkLywgL2Rhcndpbi4qXFwuemlwJC8sIC9tYWNPUy4qXFwuemlwJC8sIC9tYWMuKlxcLnppcCQvLCAvXFwuZG1nJC9dLFxuICAgICAgbGludXg6IFsvXFwucnBtJC8sIC9cXC5kZWIkL10sXG4gICAgfTtcblxuICAgIHBvc3NpYmxlQXNzZXRzID0gYXNzZXRzLmZpbHRlcigoYXNzZXQpID0+IHtcbiAgICAgIGNvbnN0IHRhcmdldFN1ZmZpeGVzID0gaW5zdGFsbFRhcmdldHNbcHJvY2Vzcy5wbGF0Zm9ybV07XG4gICAgICBmb3IgKGNvbnN0IHN1ZmZpeCBvZiB0YXJnZXRTdWZmaXhlcykge1xuICAgICAgICBpZiAoc3VmZml4LnRlc3QoYXNzZXQubmFtZSkpIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgaWYgKHBvc3NpYmxlQXNzZXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmluZCBhbnkgaW5zdGFsbGFibGUgYXNzZXRzIGZvciB0YXJnZXQgcGxhdGZvcm06ICR7Y2hhbGsuY3lhbihgJHtwcm9jZXNzLnBsYXRmb3JtfWApfWApO1xuICAgIH1cbiAgfSk7XG5cbiAgaW5mbyhpbnRlcmFjdGl2ZSwgYEZvdW5kIGxhdGVzdCByZWxlYXNlJHtwcmVyZWxlYXNlID8gJyAoaW5jbHVkaW5nIHByZXJlbGVhc2VzKScgOiAnJ306ICR7Y2hhbGsuY3lhbihsYXRlc3RSZWxlYXNlLnRhZ19uYW1lKX1gKTtcblxuICBsZXQgdGFyZ2V0QXNzZXQgPSBwb3NzaWJsZUFzc2V0c1swXTtcbiAgaWYgKHBvc3NpYmxlQXNzZXRzLmxlbmd0aCA+IDEpIHtcbiAgICB0YXJnZXRBc3NldCA9IGF3YWl0IFByb21pc2UucmVzb2x2ZShjaG9vc2VBc3NldChwb3NzaWJsZUFzc2V0cykpO1xuICB9XG5cbiAgY29uc3QgdG1wZGlyID0gcGF0aC5yZXNvbHZlKG9zLnRtcGRpcigpLCAnZm9yZ2UtaW5zdGFsbCcpO1xuICBjb25zdCBwYXRoU2FmZVJlcG8gPSByZXBvLnJlcGxhY2UoL1svXFxcXF0vZywgJy0nKTtcbiAgY29uc3QgZmlsZW5hbWUgPSBgJHtwYXRoU2FmZVJlcG99LSR7bGF0ZXN0UmVsZWFzZS50YWdfbmFtZX0tJHt0YXJnZXRBc3NldC5uYW1lfWA7XG5cbiAgY29uc3QgZnVsbEZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHRtcGRpciwgZmlsZW5hbWUpO1xuICBpZiAoIShhd2FpdCBmcy5wYXRoRXhpc3RzKGZ1bGxGaWxlUGF0aCkpIHx8IChhd2FpdCBmcy5zdGF0KGZ1bGxGaWxlUGF0aCkpLnNpemUgIT09IHRhcmdldEFzc2V0LnNpemUpIHtcbiAgICBhd2FpdCBmcy5ta2RpcnModG1wZGlyKTtcbiAgICBhd2FpdCBkb3dubG9hZFRvRmlsZShmdWxsRmlsZVBhdGgsIHRhcmdldEFzc2V0LmJyb3dzZXJfZG93bmxvYWRfdXJsKTtcbiAgfVxuXG4gIGF3YWl0IGFzeW5jT3JhKCdJbnN0YWxsaW5nIEFwcGxpY2F0aW9uJywgYXN5bmMgKGluc3RhbGxTcGlubmVyKSA9PiB7XG4gICAgY29uc3QgaW5zdGFsbEFjdGlvbnM6IHtcbiAgICAgIFtrZXk6IHN0cmluZ106IHtcbiAgICAgICAgW2tleTogc3RyaW5nXTogdHlwZW9mIEluc3RhbGxlckltcGw7XG4gICAgICB9O1xuICAgIH0gPSB7XG4gICAgICB3aW4zMjoge1xuICAgICAgICAnLmV4ZSc6IEV4ZUluc3RhbGxlcixcbiAgICAgIH0sXG4gICAgICBkYXJ3aW46IHtcbiAgICAgICAgJy56aXAnOiBaaXBJbnN0YWxsZXIsXG4gICAgICAgICcuZG1nJzogRE1HSW5zdGFsbGVyLFxuICAgICAgfSxcbiAgICAgIGxpbnV4OiB7XG4gICAgICAgICcuZGViJzogRGViSW5zdGFsbGVyLFxuICAgICAgICAnLnJwbSc6IFJQTUluc3RhbGxlcixcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IHN1ZmZpeEZuSWRlbnQgPSBPYmplY3Qua2V5cyhpbnN0YWxsQWN0aW9uc1twcm9jZXNzLnBsYXRmb3JtXSkuZmluZCgoc3VmZml4KSA9PiB0YXJnZXRBc3NldC5uYW1lLmVuZHNXaXRoKHN1ZmZpeCkpO1xuICAgIGlmICghc3VmZml4Rm5JZGVudCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBpbnN0YWxsZXIgdG8gaGFuZGxlIFwiJHt0YXJnZXRBc3NldC5uYW1lfVwiYCk7XG4gICAgfVxuICAgIGNvbnN0IEluc3RhbGxlckNsYXNzID0gaW5zdGFsbEFjdGlvbnNbcHJvY2Vzcy5wbGF0Zm9ybV1bc3VmZml4Rm5JZGVudF07XG4gICAgY29uc3QgaW5zdGFsbGVyID0gbmV3IEluc3RhbGxlckNsYXNzKCk7XG4gICAgYXdhaXQgaW5zdGFsbGVyLmluc3RhbGwoeyBpbnN0YWxsU3Bpbm5lciwgZmlsZVBhdGg6IGZ1bGxGaWxlUGF0aCB9KTtcbiAgfSk7XG59O1xuIl0sIm5hbWVzIjpbImQiLCJkZWJ1ZyIsIkdJVEhVQl9BUEkiLCJJbnN0YWxsZXJJbXBsIiwiSW5zdGFsbGVyQmFzZSIsIm5hbWUiLCJpbnRlcmFjdGl2ZSIsInByZXJlbGVhc2UiLCJyZXBvIiwiY2hvb3NlQXNzZXQiLCJhc3luY09yYSIsIkVycm9yIiwibGF0ZXN0UmVsZWFzZSIsInBvc3NpYmxlQXNzZXRzIiwic2VhcmNoU3Bpbm5lciIsImluY2x1ZGVzIiwicmVsZWFzZXMiLCJmZXRjaCIsImpzb24iLCJlcnIiLCJtZXNzYWdlIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiZmlsdGVyIiwicmVsZWFzZSIsInNvcnRlZFJlbGVhc2VzIiwic29ydCIsInJlbGVhc2VBIiwicmVsZWFzZUIiLCJ0YWdBIiwidGFnX25hbWUiLCJzdWJzdHIiLCJ0YWdCIiwic2VtdmVyIiwiZ3QiLCJ0ZXh0IiwiYXNzZXRzIiwiaW5zdGFsbFRhcmdldHMiLCJ3aW4zMiIsImRhcndpbiIsImxpbnV4IiwiYXNzZXQiLCJ0YXJnZXRTdWZmaXhlcyIsInByb2Nlc3MiLCJwbGF0Zm9ybSIsInN1ZmZpeCIsInRlc3QiLCJjaGFsayIsImN5YW4iLCJpbmZvIiwidGFyZ2V0QXNzZXQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRtcGRpciIsInBhdGgiLCJvcyIsInBhdGhTYWZlUmVwbyIsInJlcGxhY2UiLCJmaWxlbmFtZSIsImZ1bGxGaWxlUGF0aCIsImZzIiwicGF0aEV4aXN0cyIsInN0YXQiLCJzaXplIiwibWtkaXJzIiwiZG93bmxvYWRUb0ZpbGUiLCJicm93c2VyX2Rvd25sb2FkX3VybCIsImluc3RhbGxTcGlubmVyIiwiaW5zdGFsbEFjdGlvbnMiLCJFeGVJbnN0YWxsZXIiLCJaaXBJbnN0YWxsZXIiLCJETUdJbnN0YWxsZXIiLCJEZWJJbnN0YWxsZXIiLCJSUE1JbnN0YWxsZXIiLCJzdWZmaXhGbklkZW50IiwiT2JqZWN0Iiwia2V5cyIsImZpbmQiLCJlbmRzV2l0aCIsIkluc3RhbGxlckNsYXNzIiwiaW5zdGFsbGVyIiwiaW5zdGFsbCIsImZpbGVQYXRoIl0sIm1hcHBpbmdzIjoiOzs7OztBQUF5QixHQUEyQixDQUEzQixTQUEyQjtBQUNsQyxHQUFPLENBQVAsTUFBTztBQUNQLEdBQU8sQ0FBUCxNQUFPO0FBQ1AsR0FBWSxDQUFaLFVBQVk7QUFDZixHQUFVLENBQVYsUUFBVTtBQUNWLEdBQUksQ0FBSixHQUFJO0FBQ0YsR0FBTSxDQUFOLEtBQU07QUFDSixHQUFRLENBQVIsT0FBUTtBQUVELEdBQWdDLENBQWhDLGNB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