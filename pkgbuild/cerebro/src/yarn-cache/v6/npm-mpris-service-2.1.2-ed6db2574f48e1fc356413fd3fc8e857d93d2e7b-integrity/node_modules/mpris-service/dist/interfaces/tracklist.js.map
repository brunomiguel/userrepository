{"version":3,"sources":["interfaces/tracklist.js"],"names":["MprisInterface","require","dbus","Variant","types","property","method","signal","DBusError","ACCESS_READ","ACCESS_WRITE","ACCESS_READWRITE","interface","TracklistInterface","constructor","player","tracksPlain","setProperty","signature","access","_Tracks","_CanEditTracks","inSignature","outSignature","trackIds","tracks","filter","t","some","id","map","metadataToDbus","uri","afterTrack","setAsCurrent","emit","trackId","replacedPlain","setTracks","metadata","path","module","exports"],"mappings":"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","sourcesContent":["let MprisInterface = require('./mpris-interface');\nlet dbus = require('dbus-next');\nlet Variant = dbus.Variant;\nlet types = require('./types');\n\nlet {\n  property, method, signal, DBusError,\n  ACCESS_READ, ACCESS_WRITE, ACCESS_READWRITE\n} = dbus.interface;\n\nclass TracklistInterface extends MprisInterface {\n  constructor(player) {\n    super('org.mpris.MediaPlayer2.TrackList', player);\n  }\n\n  _Tracks = [];\n  _CanEditTracks = false;\n\n  setTracks(tracksPlain) {\n    this.setProperty('Tracks', tracksPlain);\n  }\n\n  @property({signature: 'ao', access: ACCESS_READ})\n  get Tracks() {\n    return this._Tracks;\n  }\n\n  @property({signature: 'b', access: ACCESS_READ})\n  get CanEditTracks() {\n    return this._CanEditTracks;\n  }\n\n  @method({inSignature: 'ao', outSignature: 'aa{sv}'})\n  GetTracksMetadata(trackIds) {\n    return this.player.tracks.filter((t) => {\n      return trackIds.some((id) => id === t['mpris:trackid']);\n    }).map(types.metadataToDbus);\n  }\n\n  @method({inSignature: 'sob'})\n  AddTrack(uri, afterTrack, setAsCurrent) {\n    this.player.emit('addTrack', { uri, afterTrack, setAsCurrent });\n  }\n\n  @method({inSignature: 'o'})\n  RemoveTrack(trackId) {\n    this.player.emit('removeTrack', trackId);\n  }\n\n  @method({inSignature: 'o'})\n  GoTo(trackId) {\n    this.player.emit('goTo', trackId);\n  }\n\n  @signal({signature: 'aoo'})\n  TrackListReplaced(replacedPlain) {\n    this.setTracks(replacedPlain);\n    // TODO what's the active track?\n    return [\n      this._Tracks,\n      '/org/mpris/MediaPlayer2/TrackList/NoTrack'\n    ];\n  }\n\n  @signal({signature: 'a{sv}'})\n  TrackAdded(metadata) {\n    return types.metadataToDbus(metadata);\n  }\n\n  @signal({signature: 'o'})\n  TrackRemoved(path) {\n    return path;\n  }\n\n  @signal({signature: 'oa{sv}'})\n  TrackMetadataChanged(path, metadata){ \n    return [\n      path,\n      types.metadataToDbus(metadata)\n    ];\n  }\n}\n\nmodule.exports = TracklistInterface;\n"],"file":"tracklist.js","sourceRoot":"../../src/"}