{"version":3,"file":"client.js","sourceRoot":"","sources":["../../src/main/client.ts"],"names":[],"mappings":";;;AAAA,qCAAiD;AAEjD,uCAAoD;AAGpD,qCAAwC;AACxC,qCAA6C;AAC7C,yCAA6C;AAE7C,8DAA8D;AAC9D;IAAgC,sCAAwC;IACtE;;;OAGG;IACH,oBAAmB,OAAwB;eACzC,kBAAM,qBAAW,EAAE,OAAO,CAAC;IAC7B,CAAC;IAED;;;;;;OAMG;IACI,oCAAe,GAAtB,UAAuB,IAAY,EAAE,KAAiB,EAAE,KAAa;QAArE,iBAuBC;QAvBoC,sBAAA,EAAA,UAAiB;QACpD,IAAI,OAA2B,CAAC;QAEhC,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;QAEtB,KAAK,CAAC,IAAI,sBAAK,UAAU,EAAE,QAAQ,IAAK,KAAK,CAAC,IAAI,CAAE,CAAC;QAErD,6FAA6F;QAC7F,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC,IAAI,CAC9C,UAAA,UAAU;YACR,IAAI,UAAU,EAAE;gBACd,OAAO,GAAG,UAAU,IAAI,UAAU,CAAC,QAAQ,CAAC;gBAC5C,KAAI,CAAC,WAAW,EAAE,CAAC,cAAc,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aACrD;YACD,KAAI,CAAC,WAAW,IAAI,CAAC,CAAC;QACxB,CAAC,EACD,UAAA,MAAM;YACJ,cAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACrB,KAAI,CAAC,WAAW,IAAI,CAAC,CAAC;QACxB,CAAC,CACF,CAAC;QAEF,OAAO,OAAO,CAAC;IACjB,CAAC;IAED;;OAEG;IACI,iCAAY,GAAnB,UAAoB,KAAY,EAAE,IAAgB,EAAE,KAAa;QAC/D,KAAK,CAAC,IAAI,sBAAK,UAAU,EAAE,YAAY,IAAK,KAAK,CAAC,IAAI,CAAE,CAAC;QACzD,OAAO,iBAAM,YAAY,YAAC,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAChD,CAAC;IAED;;OAEG;IACI,qCAAgB,GAAvB,UAAwB,CAAU;QAChC,OAAO;IACT,CAAC;IAED;;OAEG;IACO,kCAAa,GAAvB,UAAwB,KAAY,EAAE,KAAa,EAAE,IAAgB;QAArE,iBAYC;QAXC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,IAAI,MAAM,CAAC;QAE1C,OAAO,iBAAM,aAAa,YAAC,KAAK,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,UAAC,WAAyB;YAC5E,OAAA,IAAI,mBAAW,CAAQ,UAAM,OAAO;;;;;iCAC9B,WAAW,EAAX,wBAAW;4BACb,KAAA,OAAO,CAAA;4BAAC,KAAA,0BAAc,CAAA;4BAAC,qBAAM,0BAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,WAAW,CAAC,EAAA;;4BAAjF,kBAAQ,kBAAe,SAA0D,EAAC,EAAC,CAAC;;;4BAEpF,OAAO,CAAC,WAAW,CAAC,CAAC;;;;;iBAExB,CAAC,CAAC,IAAI,CAAC,UAAC,CAAe,IAAK,OAAA,CAAC,EAAD,CAAC,CAAC;QAN/B,CAM+B,CAChC,CAAC;IACJ,CAAC;IACH,iBAAC;AAAD,CAAC,AAxED,CAAgC,iBAAU,GAwEzC;AAxEY,gCAAU","sourcesContent":["import { BaseClient, Scope } from '@sentry/core';\nimport { Event, EventHint } from '@sentry/types';\nimport { logger, SyncPromise } from '@sentry/utils';\n\nimport { ElectronClient, ElectronOptions } from '../common';\nimport { MainBackend } from './backend';\nimport { addEventDefaults } from './context';\nimport { normalizeEvent } from './normalize';\n\n/** Frontend implementation for Electron renderer backends. */\nexport class MainClient extends BaseClient<MainBackend, ElectronOptions> implements ElectronClient {\n  /**\n   * Creates a new Electron SDK instance.\n   * @param options Configuration options for this SDK.\n   */\n  public constructor(options: ElectronOptions) {\n    super(MainBackend, options);\n  }\n\n  /**\n   * Uploads a native crash dump (Minidump) to Sentry.\n   *\n   * @param path The relative or absolute path to the minidump.\n   * @param event Optional event payload to attach to the minidump.\n   * @param scope Optional SDK scope used to upload.\n   */\n  public captureMinidump(path: string, event: Event = {}, scope?: Scope): string | undefined {\n    let eventId: string | undefined;\n\n    this._processing += 1;\n\n    event.tags = { event_type: 'native', ...event.tags };\n\n    // We are not calling _processEvent here since we do not have beforeSend for minidump crashes\n    this._prepareEvent(event, scope, undefined).then(\n      finalEvent => {\n        if (finalEvent) {\n          eventId = finalEvent && finalEvent.event_id;\n          this._getBackend().uploadMinidump(path, finalEvent);\n        }\n        this._processing -= 1;\n      },\n      reason => {\n        logger.error(reason);\n        this._processing -= 1;\n      },\n    );\n\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureEvent(event: Event, hint?: EventHint, scope?: Scope): string | undefined {\n    event.tags = { event_type: 'javascript', ...event.tags };\n    return super.captureEvent(event, hint, scope);\n  }\n\n  /**\n   * Does nothing in main/node\n   */\n  public showReportDialog(_: unknown): void {\n    // noop\n  }\n\n  /**\n   * @inheritDoc\n   */\n  protected _prepareEvent(event: Event, scope?: Scope, hint?: EventHint): PromiseLike<Event | null> {\n    event.platform = event.platform || 'node';\n\n    return super._prepareEvent(event, scope, hint).then((filledEvent: Event | null) =>\n      new SyncPromise<Event>(async resolve => {\n        if (filledEvent) {\n          resolve(normalizeEvent(await addEventDefaults(this._options.appName, filledEvent)));\n        } else {\n          resolve(filledEvent);\n        }\n      }).then((e: Event | null) => e),\n    );\n  }\n}\n"]}